
<?php
	$refererSet = false;
	if(Mage::getSingleton('core/session')->getReferer()) {
		$refererSet = true;
	}

	if($refererSet) {
		//get the referrer
		if (isset($_SERVER['HTTP_REFERER'])) {
			$referer = $_SERVER['HTTP_REFERER'];
		} else {
			$referer = "unknown";
		}
		//save it in a session variable
		Mage::getSingleton('core/session')->setReferer($referer); // store session data
	}
	else {
		$referer = Mage::getSingleton('core/session')->getReferer();
	}
?>
<div id="male-status">
	<div id="male-header" class="male-header">
		<div class="container">
			<div class="one-third column">
				<a id="logo" href="/" class="logo-button">
					<img class="gift-logo scale-with-grid" alt="BRANDiD logo" src="<?php echo $this->getSkinUrl('images/logo-beta.png')?>" title="BRANDiD Logo"/>
				</a>
				<div class="title-skip mobile">
					<a class="skip-this" href="#">Skip this</a>
				</div>
			</div>
			<div class="one-third column male-round">
				<div class="male-holder">
					<div id="male-colour" class="male-loading">
					</div>
					<div id="male-loader" class="male-loader">
					</div>
					
					<img src="<?php echo $this->getSkinUrl('images/male/male-round.png'); ?>" alt="MALE" class="male-round ani" title="feed the male"/>
					<div class="male-label-box">
						<span id="male-label">MALE&trade;</span>
					</div>
				</div>
				<div id="status">Establishing Connection</div>

			</div>
			<div class="one-third column">
				<div class="title-skip">
					<!-- <div class="male-title">
						Feed the Male&trade;
					</div> -->
					<a class="skip-this" href="#">Skip this</a>
				</div>
			</div>
		</div>
	</div>
	<div class="container">
<!-- 		<div class="ten columns offset-by-three">
 -->			<div id="console"></div>
<!-- 		</div>
 -->	</div>
</div>
<script type="text/javascript">
	var $j = jQuery.noConflict();
	
	createPunter();
	
	function workImages(appendTo) {
	
		var delay = getDelayRequired();
		// type has to go after, otherwise the delay counts only one or two chars
		typeit();

		var images = new Array();
		images[0] = new Array("<?php echo $this->getSkinUrl('images/male/work/1.jpg'); ?>", "work-image", "a. Smart");
		images[1] = new Array("<?php echo $this->getSkinUrl('images/male/work/2.jpg'); ?>", "work-image", "b. Casual");
		images[2] = new Array("<?php echo $this->getSkinUrl('images/male/work/3.jpg'); ?>", "work-image", "c. Hacker");
		images[3] = new Array("<?php echo $this->getSkinUrl('images/male/work/4.jpg'); ?>", "work-image", "d. Gorilla Suit");

		var imageString = printImage(images);
		performAppend(appendTo, delay, imageString);
	}

	function offside() {
		
	    // fade
		if($j('.console-fade').length == 0) { $j('#console').prepend('<div class="console-fade"></div>'); };

		var s = getLatestSpan();

		var delay = getDelayRequired();

		typeit();

		var images = new Array();
		images[0] = new Array("<?php echo $this->getSkinUrl('images/male/offside.jpg'); ?>","offside", "Which player is offside?");

		var imageString = printImage(images);
		performAppend(s, delay, imageString);
		setTimeout('offsideQ()',delay);
	}
	function initiate() {
		//give the header an id, this saves complications down the line
        $j('.jqconsole-header span').attr('id','male-welcome-msg');
        $j('#male-welcome-msg').typewriter();
        $j('#male-welcome-msg').css('color', '#444');
    	window.scrollTo(0,0);
    	jqconsole.Focus;
	}
	function startConsole() {

		if(punter.fname != undefined) {
	        var backMessage = new Array(", I thought you were gone forever! ", ", missing me already, eh? ", ", I knew you\'d be back. I could feel it. ");
	        var i = Math.floor(Math.random()*3);
        	jqconsole = $j('#console').jqconsole('Hey '+punter.fname+backMessage[i], ' >>> ');
        	
        	setTimeout('returningVisitor();',1500);
        	initiate();
        }
        else {
        	jqconsole = $j('#console').jqconsole('Greetings earthling. MALEâ„¢ here, what\'s your name? ', ' >>> ');	
	        $j('#male-welcome-msg').typewriter();
	        $j('#male-welcome-msg').css('color', '#444');
			startPrompt();
			initiate();

        }

	}

</script>

<script type="text/javascript">
	function getReferer() {
		var referer;
		referer = '<?php echo $referer; ?>';
		return referer;
	}
</script>

<script type="text/javascript">
	function loaded(){
			jQuery('#male-status').addClass('online');
			jQuery('.male-header').addClass('flyup');
			jQuery('#male-colour').removeClass('male-loading');
			jQuery('#male-colour').addClass('male-back');
			jQuery('#status').text('');
			setTimeout("startConsole()", 300);
		}

	jQuery(document).ready(function() {
		window.scrollTo(0,0);
		setTimeout("loaded()", 1000);
	});

</script>

