<div ng-app="ngMaleApp">

  <div id="loginModalGuy" class="fade modal login" ui-modal style="display:none;" ng-model="loginModalShown">
    <div class="modal-header clearfix"><h1 class="float-left">Login</h1></div>
    <div class="modal-body">
      
      <a class="facebook-connect center-align" ng-click="fbLoginFromHeader()"></a>
      <div class="fullWidth center-align facebook-connect-label">Supercharge M.A.L.E.'s intelligence with Facebook</div>

    </div>
    <div class="modal-footer">
      <form name="modalLoginForm" id="modal-login-form" class="modal-form" ng-submit="loginWithEmail()" novalidate>
        <div class="error ani fadeIn" style="display:none"></div>
        <span class="input-label">Email</span>
        <input type="email" ng-model="loginAttempt.email" placeholder="bruce@wayne-enterprises.com" ui-validate required>
        <span class="input-label">Password</span>
        <input type="password" ng-model="loginAttempt.password" placeholder="iamthebatman" required>
        <button type="submit" class="convert" ng-disabled="modalLoginForm.$invalid">Login</button>
      </form>
        <!-- <div class="image-and-copy-container small clearfix">
            
            <div class="v-outer-container aside-facebook-connect">
              <div class="v-inner-container">
                <div class="v-aligned-element">
                  <span class="facebook-reason-copy">or <a ng-click="$emit('goToRegister')">Register via email</a></span>
                </div>
              </div>
            </div> 
        </div> -->
    </div>
  </div>

  <div id="registerModalGuy" class="fade modal register" ui-modal style="display:none;" ng-model="registerModalShown">
    <div class="modal-header"><h1>Register</h1></div>
    <div class="modal-body">
      <form name="modalRegisterForm" id="modal-register-form" class="modal-form" ng-submit="register()" novalidate>
        <div class="error ani fadeIn" style="display:none"></div>
        <span class="input-label">First name</span>
        <input type="text" ng-model="registrationAttempt.first_name" placeholder="Bruce" autofocus="autofocus" required>
        <span class="input-label">Email</span>
        <input type="email" ng-model="registrationAttempt.email" placeholder="bruce@wayne-enterprises.com" ui-validate required>
        <span class="input-label">Choose a password</span>
        <input type="password" ng-model="registrationAttempt.password" placeholder="iamthebatman" required>
        <button type="submit" class="convert" ng-disabled="modalRegisterForm.$invalid">Register</button>
      </form>
    </div>
    <div class="modal-footer">
      <span class="">Already registered? <a ng-click="$emit('goToLogin')">Login</a></span>
      <!-- <a class="convert secondary" ng-click="loginModalShown=false" href="">Close</a> -->
    </div>
  </div>

  <div id="myAccountModalGuy" class="fade modal" ui-modal style="display:none;" ng-model="myAccountModalShown">
    <div class="modal-header"><h1>Guess What?</h1></div>
    <div class="modal-body">
      We've disabled My Account whilst we perform some upgrades. 
    </div>
    <div class="wufoo-form">
      <div id="wufoo-z7x3p9">
        Fill out my <a href="http://brandid.wufoo.com/forms/z7x3p9">online form</a>.
        </div>
        <script type="text/javascript">var z7x3p9;(function(d, t) {
        var s = d.createElement(t), options = {
        'userName':'brandid', 
        'formHash':'z7x3p9', 
        'autoResize':true,
        'height':'502',
        'async':true,
        'header':'show'};
        s.src = ('https:' == d.location.protocol ? 'https://' : 'http://') + 'wufoo.com/scripts/embed/form.js';
        s.onload = s.onreadystatechange = function() {
        var rs = this.readyState; if (rs) if (rs != 'complete') if (rs != 'loaded') return;
        try { z7x3p9 = new WufooForm();z7x3p9.initialize(options);z7x3p9.display(); } catch (e) {}};
        var scr = d.getElementsByTagName(t)[0], par = scr.parentNode; par.insertBefore(s, scr);
        })(document, 'script');</script>
    </div>
    <div class="modal-footer">
      <a class="convert secondary" ng-click="myAccountModalShown=false">Close</a>
    </div>
  </div>

  <div id="top" class="keep-calm-signup-container">
    <?php echo $this->getChildHtml('landing_header'); ?>
  </div>


  <!-- <div class="chisel-block header">
    <div class="container">
      <div class="logo-container">
        <a id="logo" href="/" class="header-logo">
          <img class="gift-logo ani fadeIn scale-with-grid" alt="BRANDiD logo" src="<?php // echo $this->getSkinUrl('images/logo-beta.png')?>" title="BRANDiD Logo"/>
        </a>
      </div>
    </div>
  </div>
   -->
 <div class="container maleApp withShadow grey-back drawerOpen-{{drawerOpen}}" ng-init="drawerOpen = false" ng-controller="MainController">


  <div  class="drawer-holder shadow-trick-holder" >
    <div class="drawer shadow-trick right">
      <a ng-click="drawerOpen = !drawerOpen" class="button-overlay over-male" style="width:100%">
        <div class="male-round">
          <div class="male-holder">
            <div id="male-colour" class="male-back">
            </div>
            
            <img src="<?php echo $this->getSkinUrl('images/male/male-transparent@2x.png'); ?>" alt="M.A.L.E." class="male-round ani" title="feed the male"/>
            <div class="male-label-box">
              <span id="male-label">M.A.L.E.</span>
            </div>
          </div>
          <a href="https://twitter.com/intent/tweet?screen_name=male" class="twitter-mention-button" data-related="arush">Tweet to @male</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        </div>
      </a>

      <ul>
        <li class="menu-section trans ani open" ng-repeat="menuItem in menu">
          <!-- <a class="button-overlay" href="#/section/{{menuItem.section}}"> -->
            <div class="shadow-trick-holder">
              <div class="chisel-block shadow-trick bottom">
               <span>{{menuItem.title}}</span> 
              </div>
            </div>
          <!-- </a> -->
          <div ng-include src="menuItem.submenuTemplate"></div>

        </li>
      </ul>
    </div>
  </div>

  <div class="rest-of-page {{routeParams.category}}">
    <div class="controls chisel-block clearfix" ng-controller="DetailControlsController">
      <div class="controls-content clearfix">
        <a ng-click="$parent.drawerOpen = !$parent.drawerOpen" class="button-overlay">
          <div class="menu-button">
          </div>
        </a>
      </div>
    <!-- TODO: pagination control -->
    </div>

    <!-- detail loads here -->

    <div id="detailView" class="grey-back" ng-view>
    </div>
    <div class="feedback-on-this-page big-bottom-margin">
        <form name="feedbackForm">
          <input type="hidden" name="section" ng-model="routeParams.section">
          <input type="hidden" name="category" ng-model="routeParams.category">
          <input type="hidden" name="question" ng-model="routeParams.question">
          <input type="hidden" name="browser" ng-model="feedback.browser">
          <input type="hidden" name="OS" ng-model="feedback.OS">
          <div class="field-with-submit-button-container clearfix">
            <input id="feedback-message-text" name="text" ng-model="feedback.message" placeholder="Feedback on this page..." required/>
            <button ng-hide="feedbackForm.$invalid" type="submit" class="submit convert secondary" ng-click="submitFeedback(routeParams.section,routeParams.category,routeParams.question)">submit</button>
          </div>
          
        </form>
        

    </div>
  </div>

</div> <!-- end ngMaleApp -->

  <!-- Workaround to dynamically load :primaryNav/:secondaryNav templates -->
  <script type=text/ng-template id=detailViewProxy.html>
      <div ng-include src="detailTemplate"></div>
  </script>
  <script type=text/ng-template id=sectionProxy.html>
      <div ng-include src="sectionTemplate"></div>
  </script>
  <script type=text/ng-template id=categoryProxy.html>
      <div ng-include src="categoryTemplate"></div>
  </script>

  <!-- Inline Templates (Partials) -->

  <!-- garms submenu is special because it will contain what the user has selected to configure, they might not want to configure everything -->
  <script type=text/ng-template id=menu/catalogItems.html>
    <div ng-repeat="chosenItem in chosenItems"  class="ani big-block clearfix" ng-class="{selected: chosenItem.category==$parent.routeParams.category}">
      <a href="{{catalogItem.link}}" class="button-overlay">
        <div class="icon {{chosenItem.cssClass}}"></div>
        <div class="ani arrow-left"></div>
      </a>
    </div>
  </script>

  <!-- this is for all other submenu items -->
  <script type=text/ng-template id=menu/menuItems.html>
    <div ng-repeat="submenuItem in menuItem.submenuItems" class="ani big-block clearfix {{submenuItem.cssClass}}-container" ng-class="{selected: submenuItem.question==selectedSubmenuItem}">
      
      <!-- the link here skips the dashboard, because no need for a dashboard for simple questions -->
      <a href="#/section/{{routeParams.section}}/category/{{routeParams.category}}/question/{{submenuItem.question}}" class="button-overlay">
        <div class="icon {{submenuItem.cssClass}}">
          <div class="v-outer-container">

            <div class="v-inner-container">

              <div class="v-aligned-element">
                <span class="submenuItem-label">{{submenuItem.label}}</span>
              </div>
            </div>
          </div>

        </div>
        <div class="ani arrow-left"></div>
      </a>
    </div>
  </script>

  <script type=text/ng-template id=start.html>
      <div class="">M.A.L.E. Beginning</div>
  </script>
  <script type=text/ng-template id=section/garms/category/intro.html>
      <div class="slide-container clearfix fadeIn ani">
        <div class="curved-white-block withShadow withRadius intro">
          <div class="male-round">
            <div class="male-holder">
              <div id="male-colour" class="male-back">
              </div>
              
              <img src="<?php echo $this->getSkinUrl('images/male/male-round-white@2x.png'); ?>" alt="M.A.L.E." class="male-round ani" title="feed the male"/>
              <div class="male-label-box">
                <span id="male-label">M.A.L.E.</span>
              </div>
            </div>
          </div>

          <span id="intro" class="question">{{question}}</span>
        </div>

        <div class="answers multi-button-set">
          <a class="convert secondary size-auto-populator total-num-buttons-{{totalNumButtons}} first-{{$first}} last-{{$last}}" ng-click="selectItem($index)" ng-repeat="answer in answers" ng-class="{active: sizeButton.isActive}">
            <div class="v-outer-container">
              <div class="v-inner-container">
                <div class="v-aligned-element">
                  <div class="icon ">{{answer.label}}</div>
                </div>
              </div>
            </div>
          </a>
        </div>
        
      </div>

  </script>

  <script type=text/ng-template id=section/garms/category/generic/question/save.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="SaveFormController">
          <h1 class="question-title">{{saveTitle}}</h1>
          <span id="brands" class="question">{{question}}</span>

          <div class="half-column big-top-margin">
            <div class="curved-white-block withShadow withRadius">

              <div class="">
                <div class="image-and-copy-container small clearfix">
                  
                  <a class="facebook-connect center-align" type="submit" ng-click="fbLoginAndSave()">
                  </a>
                  <div class="fullWidth top-margin center-align">
                    <span class="facebook-reason-copy">{{facebookSubtitle}}</span>
                  </div>
                </div>
              </div>

              <div class="image-and-copy-container small">
                <div class="image-and-copy clearfix" ng-repeat="facebookReason in facebookReasons">
                  <img ng-src="{{facebookReason.imageUrl}}" class="float-left small-square-image">
                  <div class="v-outer-container">

                    <div class="v-inner-container">

                      <div class="v-aligned-element">
                        <span class="facebook-reason-copy">{{facebookReason.reasonCopy}}</span>
                      </div>
                    
                    </div>

                  </div>

                </div>

              </div>

              <div class="fullWidth center-align">
                <a style="width:100%" class="fullWidth convert secondary" ng-click="$emit('goToRegister')">or Register via email</a>
              </div>


            </div>
          </div> <!-- third-column -->

          <div class="half-column big-top-margin">
            <img ng-src="{{emailImage}}" class="center-align scale-with-grid">
          </div>
          
        </form>

        
      </div>

  </script>

  <script type=text/ng-template id=section/garms/category/generic/question/checkout.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="CheckoutFormController">
          
          <span id="brands" class="question">{{question}}</span>
          <h1 class="question-title">{{basketTitle}}</h1>
            <span class="bold">Brands:</span> <span class="basket-items">{{basket.brands}}</span><br/>
            
            <span class="bold">Size:</span> <span class="basket-items">{{basket.size}}</span><br/>
            <span class="bold">Colours:</span> <span class="basket-items">{{basket.colours}}</span><br/>
            <span class="bold">Specifics:</span> <span class="basket-items">{{basket.specifics}}</span>


          <div class="curved-white-block withShadow withRadius">
            <div class="fullWidth clearfix">
              <h1 class="question-title">{{checkoutTitle}}</h1>              
              <recurlyjs type="recurly.transactionType" payload="recurly.payload" currency="recurly.currency" subdomain="recurly.subdomain" callback="receiveRecurlyToken"></recurlyjs>
            </div>
          </div>
        </form>
      </div>
  </script>

  <script type=text/ng-template id=section/garms/category/generic/question/checkout-old.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="CheckoutFormController">
          <div class="curved-white-block withShadow withRadius">
            <div class="order-summary">
              <h1 class="question-title">{{basketTitle}}</h1>
              <div class="basket">

                <span class="bold">Brands:</span> <span class="basket-items">{{basket.brands}}</span><br/>
                <span class="bold">Size:</span> <span class="basket-items">{{basket.size}}</span><br/>
                <span class="bold">Colours:</span> <span class="basket-items">{{basket.colours}}</span><br/>
                <span class="bold">Specifics:</span> <span class="basket-items">{{basket.specifics}}</span>
              </div>
            </div>
            <div class="fullWidth clearfix">
              <h1 class="question-title">{{checkoutTitle}}</h1>
              <div class="incentive-image-container">
                <img class="scale-with-grid float-left incentive-image" ng-src="<?php echo $this->getSkinUrl('images/male/checkout'); ?>/{{checkoutIncentiveUrl}}" alt="free touchscreen gloves"/>
              </div>
              <div class="incentive-message float-left question" class="question">{{checkoutCopy}}</div>
            </div>
            <div class="next-question-button-section clearfix">
              <a class="convert submit checkout" type="submit" href="{{paymentPageUrl}}">
                    Credit my account with {{currencySymbol}}1
              </a>
            </div>

          </div>
        </form>
      </div>

  </script>

  <script type=text/ng-template id=section/garms/category/generic/question/success.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="SuccessFormController">
          <div class="curved-white-block withShadow withRadius">
            
            <div class="fullWidth clearfix">
              <h1 class="question-title">{{successTitle}}</h1>
              <div class="incentive-message float-left question" class="question">{{successCopy}}</div>
            </div>

            
            
          </div>
        </form>

        
      </div>

  </script>


  <script type=text/ng-template id=section/garms/category/generic/question/size.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="SizeFormController">

          <div class="curved-white-block withShadow withRadius">
          <h1 class="question-title">{{questionTitle}}</h1>
            <span id="size" class="question">{{question}}</span>
            
          </div>

            <div class="hint">{{howToMeasure}}</div>
            <div class="answers multi-button-set">
                
                <a class="convert secondary size-auto-populator total-num-buttons-{{totalNumButtons}} first-{{$first}} last-{{$last}}" ng-click="chooseSize(routeParams.category, sizeButton.style, $index)" ng-repeat="sizeButton in sizeButtons" ng-class="{active: sizeButton.isActive}">
                  <div class="v-outer-container">

                    <div class="v-inner-container">

                      <div class="v-aligned-element">
                        <span class="bigger-text">{{sizeButton.label}}</span><br/><span class="smaller-text">{{sizeButton.measurements}}</span>
                      </div>
                    
                    </div>

                  </div>

                </a>

            </div>
            

            <div class="next-question-button-section">
              <button class="convert submit" type="submit" ng-click="saveAnswer()">
                    Next
              </button>
            </div>

        </form>

      </div>
  </script>

  <script type=text/ng-template id=section/garms/category/generic/question/specifics.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="SpecificsFormController">

          <div class="curved-white-block withShadow withRadius">
          <h1 class="question-title">{{questionTitle}}</h1>
            <span id="specifics" class="question">{{question}}</span>
          </div>

          
            <div class="answers">
                <textarea ng-model="selectedSpecifics" name="" id="" cols="30" rows="10" class="specifics-textarea"></textarea>
            </div>

            <div class="next-question-button-section">
              <button class="convert submit" type="submit" ng-click="saveAnswer()">
                    Next
              </button>
            </div>

        </form>

      </div>
  </script>

  <script type=text/ng-template id=section/garms/category/generic/question/colours.html>
      <div class="slide-container clearfix fadeIn ani">
        <form ng-controller="ColoursFormController">

          <div class="curved-white-block withShadow withRadius">
            <h1 class="question-title">{{questionTitle}}</h1>
            <span id="colours" class="question">{{question}}</span>
          </div>

          
            <div class="answers multi-button-set">
                
                <a class="convert secondary colours-auto-populator total-num-buttons-{{totalNumButtons}} first-{{$first}} last-{{$last}}" ng-click="chooseColours(coloursButton.style, $index)" ng-repeat="coloursButton in coloursButtons" ng-class="{active: coloursButton.isActive}">
                  <div class="v-outer-container">

                    <div class="v-inner-container">

                      <div class="v-aligned-element">
                        <span class="bigger-text">{{coloursButton.label}}</span>
                      </div>
                    
                    </div>

                  </div>

                </a>

            </div>


            <div class="tag-section">
              {{typeColoursTooltip}}
              <input class="tags-field" ui-select2="{tags:colours}" ng-model="selectedColours" required/>
            </div>

            <div class="next-question-button-section">
              <button class="convert submit" type="submit" ng-click="saveAnswer()">
                    Next
              </button>
            </div>

        </form>

      </div>
  </script>

  <script type=text/ng-template id=tag.html>
    <a ng-click="clickedTag(id)" class="male-tag float-left" ng-class="{selected: isSelected}">
      <div class="status float-left"></div>
      <div class="label float-left">{{label}}</div>
    </a>
  </script>
  <script type=text/ng-template id=section/garms/category/generic/question/brands.html>
      <div class="slide-container clearfix fadeIn ani">
        <div ng-controller="BrandsFormController">

          <span id="brands" class="question">{{question}}</span>

          <!-- <div class="curved-white-block withShadow withRadius fadeIn ani">
            <h1 class="question-title">{{questionTitle}}</h1>
            
          </div> -->

            <div class="answers multi-button-set">
                
                <a class="convert secondary brands-auto-populator total-num-buttons-{{totalNumButtons}} first-{{$first}} last-{{$last}}" ng-click="chooseBrands(routeParams.category, brandsButton.brandType, $index)" ng-repeat="brandsButton in brandsButtons" ng-class="{active: brandsButton.isActive}">
                  <div class="v-outer-container">

                    <div class="v-inner-container">

                      <div class="v-aligned-element">
                        <span class="bigger-text">{{brandsButton.label}}</span><br/><span class="smaller-text">{{brandsButton.priceLower | currency: currencySymbol}} - {{brandsButton.priceUpper | currency: currencySymbol}}</span>
                      </div>
                    
                    </div>

                  </div>

                </a>

            </div>
            

            <form name="addTagForm" class="type-tag-form" novalidate>
              
              <h1 class="big-top-margin question-title on-grey">{{myTagsTitle}}</h1>

              <div class="clearfix top-margin">
                <div class="male-font field-with-submit-button-container float-left">
                  <input class="tag-input" type="text" ng-model="assets.typeahead.typeaheadValue" placeholder="Enter any brand" bs-typeahead="assets.typeahead.allBrands" autofocus="autofocus" required/>

                  <button ng-hide="addTagForm.$invalid" type="submit" class="submit convert secondary" ng-click="typeTag()">Add</button>
                </div>
                <div class="input-tooltip float-left">
                  {{tooltip}}
                </div>
              </div>

              

              <div class="big-top-margin selected-tags clearfix">
                <text-tag ng-repeat="tag in assets.selectedTags" label="tag.text" id="tag.id" is-selected="tag.isSelected" click-delegate="toggleTag"></text-tag>
              </div>

              <div class="big-top-margin next-question-button-section clearfix">
                <button class="convert submit" ng-click="saveAnswer()">
                      Done!
                </button>
              </div>
              
              <hr class="big-top-margin"/>

              <h1 class="top-margin question-title on-grey">{{suggestionsTitle}}</h1>

              <div class="suggestions big-top-margin fullWidth" ng-repeat="brand in assets.allBrands">
                <div class="third-column">

                  <div class="bottom-margin">
                    <span class="question-title on-grey smaller">{{brand.label}}</span><br/>

                    <span class="question-title on-grey">{{currencySymbol}}{{brand.data.priceRange.lower}} - {{currencySymbol}}{{brand.data.priceRange.upper}}</span>
                  </div>
                  <text-tag ng-repeat="tag in brand.data.tags" label="tag.text" id="tag.id" is-selected="tag.isSelected" click-delegate="toggleTag"></text-tag>
                </div>
              </div>

            </form>

        </div>

        

      </div>
  </script>

  <script type=text/ng-template id=section/garms.html>
      <div class="">This is the beginning of garms</div>
  </script>
  <script type=text/ng-template id=section/extras.html>
      <div class="">This is the beginning of extras</div>
  </script>

  <script type=text/ng-template id=garms/dashboard.html>
      <div id="dashboard" class="curved-white-block withShadow withRadius fadeIn ani">

          <div class="question chisel-block" ng-repeat="question in questions">
            <a class="list-item" ng-click="$parent.slideToQuestion(question.id)">
              <i class="q-icon icon-check-empty"></i>{{question.question}}<i class="q-icon icon-chevron-right"></i>
            </a>
          </div>

      </div>
  </script>

</div> <!-- ng-app -->

<script id="IntercomSettingsScriptTag">
  // var intercomSettings = parseIntercomSettings;
</script>
<script>(function(){var w=window;var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://api.intercom.io/api/js/library.js';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}})();</script>

